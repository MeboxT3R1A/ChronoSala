{% extends 'index.html' %}

{% block title %}Painel do Coordenador{% endblock %}

{% block content %}
<h1>Painel do Coordenador</h1>
<button onclick="abrirModal()">+ Nova Sala</button>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul class="flash-messages">
      {% for msg in messages %}
        <li>{{ msg }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<table border="1" cellpadding="8" cellspacing="0" style="width: 100%; border-collapse: collapse;">
  <thead>
    <tr>
      <th>Nome</th>
      <th>Status</th>
      <th>Ações</th>
    </tr>
  </thead>
  <tbody>
    {% for sala in salas %}
    <tr>
      <td>{{ sala.nome_sala }}</td>
      <td>{{ sala.status_sala.value }}</td>
      <td>
        <a href="{{ url_for('coordenador_bp.editar_sala', nome_sala=sala.nome_sala) }}" class="btn-cancelar">Editar</a>

        <form action="{{ url_for('coordenador_bp.excluir_sala', nome_sala=sala.nome_sala) }}" method="POST" style="display:inline;" 
              onsubmit="return confirm('Confirma exclusão da sala {{ sala.nome_sala }}?');">
          <button type="submit" style="background-color: #e74c3c; color: white;">Excluir</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="modal fade" id="modalNovaSala" tabindex="-1" aria-labelledby="tituloModalNovaSala" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
    
      <div class="modal-header">
        <h5 class="modal-title" id="tituloModalNovaSala">Adicionar Nova Sala</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
      </div>

      <div class="modal-body">
        <form id="formNovaSala">
          <div class="mb-3">
            <label for="nomeSala" class="form-label">Nome da Sala</label>
            <input type="text" class="form-control" id="nomeSala" required>
          </div>

          <div class="mb-3">
            <label for="capacidadeSala" class="form-label">Capacidade</label>
            <input type="number" class="form-control" id="capacidadeSala" min="0" required>
          </div>

          <div class="modal-footer">
            <button type="submit" class="btn btn-success">Salvar</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          </div>
        </form>
      </div>

    </div>
  </div>
</div>
{% endblock %}
